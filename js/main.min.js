$(document).ready(function(){
    $('.sitemap').hide();
    $('.menu_btn').click(function(){
        $('.sitemap').fadeIn();
    });
    $('.site_close').click(function(){
        $('.sitemap').fadeOut();
    });
    var num=0;
    var total=$('.photo').length;
    var imgHeight=$('.photo').height();
    console.log(imgHeight);      

    $('.photo').css('z-index',1);
    $('.p1').css('z-index',5);
    $('.small').hide();
    $('.c1').show();
    $('.txt').removeClass('active').hide();
    $('.txt:first').show().addClass('active');
    $('.number a').hide();
    $('.number a:first').show();

    $('.next_btn').click(function(){
        clearInterval(auto);             
        auto=setInterval(movefn,10000);  
        barfn();                         

        num++;
        if(num>=total) {num=0;}
        console.log(num);    //인덱스번호 초기화
        $('.photo').each(function(){
            var imgNum=$(this).index();
            if(num==imgNum){
                $('.photo').css('z-index',1);
                $(this).css({'top':imgHeight,'z-index':5});
                $(this).animate({'top':0},700,"easeOutExpo");
                $(this).prev().css('z-index',3);
            }
        });
        $('.small').each(function(){
            var centerNum=$(this).index();
            if(num==centerNum){
                $('.small').fadeOut();
                $(this).fadeIn();
            }
        });
        $('.number a').each(function(){
            var aNum=$(this).index();
            if(num==aNum){
                $('.number a').hide();
                $(this).show();
            }
        });
        $('.txt').each(function(){
            var txtNum=$(this).index();
            if(num==txtNum){
                $('.txt').removeClass('active').hide();
                $(this).show().addClass('active');
            }
        });
    });
    $('.prev_btn').click(function(){
        clearInterval(auto);            
        auto=setInterval(movefn,10000); 
        barfn();                        

        num--;
        if(num<0) {num=total-1}
        console.log(num);    //인덱스번호
        $('.photo').each(function(){
            var imgNum=$(this).index();
            if(num==imgNum){
                $('.photo').css('z-index',2);
                $(this).css({'top':-imgHeight,'z-index':5});
                $(this).animate({'top':0},700,"easeOutExpo");
                $(this).next().css('z-index',3);
                $(this).prev().css('z-index',1);
            }
        });
        $('.small').each(function(){
            var centerNum=$(this).index();
            if(num==centerNum){
                $('.small').fadeOut();
                $(this).fadeIn();
            }
        });
        $('.number a').each(function(){
            var aNum=$(this).index();
            if(num==aNum){
                $('.number a').hide();
                $(this).show();
            }
        });
        $('.txt').each(function(){
            var txtNum=$(this).index();
            if(num==txtNum){
                $('.txt').removeClass('active').hide();
                $(this).show().addClass('active');
            }
        });
    });

    var auto=setInterval(movefn,10000);
    function movefn(){
        $('.next_btn').trigger('click');
        barfn();
    }
    function barfn(){
        $('.bar').stop()
        $('.bar').css('width',0);
        $('.bar').animate({'width':'100%'},9500);
    }
    barfn();




});